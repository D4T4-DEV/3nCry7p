doctype html
html(lang="en")
    head
        meta(charset="UTF-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        link(rel='stylesheet', href='/css/global.css')
        link(rel="stylesheet", href="/css/historialEncriptaciones.css")
        link(rel="stylesheet", href="/css/notificacionErrores.css")
        link(rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200")
        link(rel="stylesheet", href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200")
        link(rel="icon" type="image/x-icon" href="/assets/IconoWeb.ico")

        title Historial de encriptaci贸n
    body 
        .container
            a(href="/" class="atras")
                span(class="material-symbols-outlined") arrow_back 
            h2.titulo-principal Historial de Encriptaciones

        .conteiner-historial
            if encriptaciones.length > 0 
                    each encriptacion in encriptaciones 
                        //- Formateo de la fecha desde JS
                        - const fechaRegistro = new Date(encriptacion.fecha_de_registro);
                        - const formateoDeFecha = { weekday: 'long', year: 'numeric', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric' };
                        - const fecha_y_Hora = fechaRegistro.toLocaleDateString('es-ES', formateoDeFecha);
                        if encriptacion.tipo_de_encriptacion === "cesar"
                            h3.tituloMetodo M茅todo Cesar
                            .contenedorResumen 
                                .contenedorEtiquetas
                                    p Texto sin encriptar
                                    p Texto encriptado
                                .contenedorTextAreas
                                    textarea(class='textarea-encrip', id=`txt-sin-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_sin_encriptar}
                                    textarea(class='textarea-crip', id=`txt-encrip-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_encriptado}
                                .contenedorCopiadores    
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-sin-${encriptacion.id}')`)
                                        span(class="material-symbols-outlined" id='copy-one' title="Copiar el texto sin encriptar") content_copy
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-encrip-${encriptacion.id}')` title="Copiar el texto encriptado")
                                        span(class="material-symbols-outlined" id='copy-two') content_copy

                            h4.datos-import Datos importantes:
                            .contenedor-cualidades 
                                    p.cualidades-txt Idioma: #{encriptacion.idioma}  
                                    p.cualidades-txt Desplazamientos: #{encriptacion.desplazamientos} 
                                    p.cualidades-txt Fecha de y hora de encriptaci贸n: #{fecha_y_Hora}


                        if encriptacion.tipo_de_encriptacion === "vigenere"
                            h3.tituloMetodo M茅todo Vigenere
                            .contenedorResumen 
                                .contenedorEtiquetas
                                    p Texto sin encriptar
                                    p Texto encriptado
                                .contenedorTextAreas
                                    textarea(class='textarea-encrip', id=`txt-sin-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_sin_encriptar}
                                    textarea(class='textarea-crip', id=`txt-encrip-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_encriptado}
                                .contenedorCopiadores    
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-sin-${encriptacion.id}')`)
                                        span(class="material-symbols-outlined" id='copy-one' title="Copiar el texto sin encriptar") content_copy
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-encrip-${encriptacion.id}')` title="Copiar el texto encriptado")
                                        span(class="material-symbols-outlined" id='copy-two') content_copy

                            h4.datos-import Datos importantes:
                            .contenedor-cualidades 
                                    p.cualidades-txt Idioma: #{encriptacion.idioma} 
                                    p.cualidades-txt Key usada: #{encriptacion.key_util} 
                                    p.cualidades-txt Fecha de y hora de encriptaci贸n: #{fecha_y_Hora}

                        if encriptacion.tipo_de_encriptacion === "hex"
                            h3.tituloMetodo M茅todo Hexadecimal
                            .contenedorResumen 
                                .contenedorEtiquetas
                                    p Texto sin encriptar
                                    p Texto encriptado
                                .contenedorTextAreas
                                    textarea(class='textarea-encrip', id=`txt-sin-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_sin_encriptar}
                                    textarea(class='textarea-crip', id=`txt-encrip-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_encriptado}
                                .contenedorCopiadores    
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-sin-${encriptacion.id}')`)
                                        span(class="material-symbols-outlined" id='copy-one' title="Copiar el texto sin encriptar") content_copy
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-encrip-${encriptacion.id}')` title="Copiar el texto encriptado")
                                        span(class="material-symbols-outlined" id='copy-two') content_copy

                            h4.datos-import Datos importantes:
                            .contenedor-cualidades 
                                    p.cualidades-txt Fecha de y hora de encriptaci贸n: #{fecha_y_Hora}


                        if encriptacion.tipo_de_encriptacion === "base64"
                            h3.tituloMetodo M茅todo Base 64
                            .contenedorResumen 
                                .contenedorEtiquetas
                                    p Texto sin encriptar
                                    p Texto encriptado
                                .contenedorTextAreas
                                    textarea(class='textarea-encrip', id=`txt-sin-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_sin_encriptar}
                                    textarea(class='textarea-crip', id=`txt-encrip-${encriptacion.id}` readonly="readonly") #{encriptacion.texto_encriptado}
                                .contenedorCopiadores    
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-sin-${encriptacion.id}')`)
                                        span(class="material-symbols-outlined" id='copy-one' title="Copiar el texto sin encriptar") content_copy
                                    a(class="copy" onclick=`copiarTextoDelTextArea('txt-encrip-${encriptacion.id}')` title="Copiar el texto encriptado")
                                        span(class="material-symbols-outlined" id='copy-two') content_copy

                            h4.datos-import Datos importantes:
                            .contenedor-cualidades 
                                    p.cualidades-txt Fecha de y hora de encriptaci贸n: #{fecha_y_Hora}

            else 
                p#parrafo No haz encriptado nada, 隆Haz uno!

            if avisoError
                div#snackbar= avisoError 
                    script.
                        const x = document.getElementById("snackbar");
                        x.className = "show";
                        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 10000);
        div#snackbar

        script.
            // Funcion para copiar el texto del textArea
            function copiarTextoDelTextArea(idTextArea) {
                var textareaToCopy = document.getElementById(idTextArea);

                textareaToCopy.select(); // Seleccionamos todo el texto dentro de este
                document.execCommand("copy"); // Ejecutamos el comando copiar

                // alert("Haz copiado el texto: " + textareaToCopy.value); // Mandamos una alerta que contendr谩 el [Texto copiado y el valor de ese texto]
                    const avisoCopiado = document.getElementById("snackbar");
                    avisoCopiado.className = "show";
                    avisoCopiado.textContent = "Haz copiado el texto"
                    setTimeout(function(){ avisoCopiado.className = avisoCopiado.className.replace("show", ""); }, 4000);
            }